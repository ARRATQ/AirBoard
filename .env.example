# =============================================================================
# Configuration Airboard - Variables d'environnement
# =============================================================================
# Pour le développement local : Créer un fichier .env avec ces valeurs
# Pour Coolify : Définir ces variables dans l'interface Coolify (Environment Variables)
# =============================================================================

# Base de données PostgreSQL
DB_HOST=localhost                         # Pour dev local / "postgres" pour Docker
DB_PORT=5432                              # Port PostgreSQL
DB_USER=airboard                          # Utilisateur base de données
DB_PASSWORD=airboard123                   # Mot de passe base de données (CHANGER EN PRODUCTION!)
DB_NAME=airboard                          # Nom de la base de données

# JWT Configuration (IMPORTANT: Générer un secret sécurisé en production!)
# Générez un secret JWT sécurisé avec au moins 32 caractères et haute entropie
# Exemple de génération: openssl rand -base64 64
# ou utilisez la fonction automatique de l'application (recommandé)
JWT_SECRET= # Laisser vide pour génération automatique sécurisée
JWT_TOKEN_EXPIRATION_HOURS=24             # Durée de validité du token d'accès (en heures)
JWT_REFRESH_EXPIRATION_DAYS=7             # Durée de validité du refresh token (en jours)

# Security Configuration (OWASP 2025)
BCRYPT_COST=12                            # Coût de hashage bcrypt (min: 10, recommandé: 12 ou 13, max: 31)
                                          # Plus élevé = plus sécurisé mais plus lent (doucement par incréments)

# Application
GIN_MODE=debug                            # Mode Gin: debug (dev) ou release (prod)
PUBLIC_URL=http://localhost                # URL publique de l'app (pour liens emails et OAuth callbacks)
                                          # Dev: http://localhost (port 80 via Docker)
                                          # Prod: https://tools.marocpme.gov.ma
SIGNUP_ENABLED=true                       # Activer/désactiver l'inscription classique (true/false)

# Frontend (Développement local uniquement)
VITE_API_URL=http://localhost:8080/api/v1 # URL de l'API pour le dev local

# Version & Updates Configuration
GITHUB_REPO=                              # Format: "owner/repo" (ex: "username/airboard")
                                          # Laissez vide pour désactiver la vérification de mise à jour
GITHUB_TOKEN=                             # Token GitHub (optionnel, pour éviter les limites de taux)
                                          # Créer un Personal Access Token sur GitHub (Settings > Developer settings)

# SSO Configuration (Authentik / Microsoft 365)
# Ces variables permettent l'intégration avec Authentik via les headers X-authentik-*
# IMPORTANT: SSO est ACTIVÉ par défaut. Mettre à false si vous n'utilisez pas Authentik.
SSO_ENABLED=true                          # true = activer SSO, false = mode classique login/password
SSO_AUTO_PROVISION=true                   # Créer automatiquement les utilisateurs depuis SSO
SSO_DEFAULT_ROLE=user                     # Rôle par défaut: user ou admin
SSO_DEFAULT_GROUP=Common                  # Groupe par défaut pour les nouveaux utilisateurs SSO
SSO_ADMIN_GROUPS=airboard-admins          # Groupes Authentik donnant le rôle admin (séparés par des virgules)

# =============================================================================
# Media Storage Configuration
# =============================================================================
# Configuration du stockage des fichiers médias (images, documents, etc.)
STORAGE_TYPE=local                        # Type de stockage: local, s3, minio
UPLOAD_DIR=./uploads                      # Répertoire de stockage local (pour STORAGE_TYPE=local)

# Configuration S3/MinIO (optionnel, pour STORAGE_TYPE=s3 ou minio)
S3_BUCKET=                                # Nom du bucket S3/MinIO
S3_REGION=                                # Région S3 (ex: us-east-1) ou auto pour MinIO
S3_ENDPOINT=                              # Endpoint personnalisé pour MinIO (ex: https://minio.example.com)
S3_ACCESS_KEY=                            # Access Key S3/MinIO
S3_SECRET_KEY=                            # Secret Key S3/MinIO

# =============================================================================
# OAuth Configuration (Google & Microsoft)
# =============================================================================
# Ces paramètres peuvent être configurés directement via l'interface admin
# dans la section OAuth Settings (/admin/oauth)
# Les valeurs ci-dessous ne sont plus nécessaires car la configuration se fait en BDD.
# Gardez cette section pour référence uniquement.
#
# Pour configurer OAuth :
# 1. Connectez-vous en tant qu'administrateur
# 2. Allez dans Administration > OAuth
# 3. Configurez les providers (Google, Microsoft) via l'interface
# =============================================================================

# =============================================================================
# Email OAuth 2.0 Configuration (Microsoft 365 Modern Authentication)
# =============================================================================
# Configuration OAuth 2.0 pour l'envoi d'emails via Microsoft 365
# Utilise Microsoft Graph API pour l'envoi (recommandé avec client_credentials)
#
# IMPORTANT: Ces paramètres sont optionnels. La configuration se fait principalement
# via l'interface admin dans Administration > Email Settings > OAuth Configuration
#
# Pour configurer :
# 1. Créer une App Registration dans Azure AD (https://portal.azure.com)
# 2. Ajouter permission API: Mail.Send (Application permission) sous Microsoft Graph
# 3. Accorder le consentement administrateur (coche verte requise)
# 4. Créer un client secret (expiration 24 mois recommandée)
# 5. Configurer via l'interface admin Airboard
#
# NOTE: Le client_credentials flow utilise Microsoft Graph API (pas SMTP).
#       L'adresse From Email doit être une boîte mail existante dans votre tenant M365.
#
# Variables d'environnement (optionnel, pour pré-configuration) :
EMAIL_OAUTH_ENABLED=false                     # Activer OAuth pour les emails (true/false)
EMAIL_OAUTH_PROVIDER=microsoft                # Provider OAuth: microsoft ou google
EMAIL_OAUTH_TENANT_ID=                        # Azure AD Tenant ID (GUID)
EMAIL_OAUTH_CLIENT_ID=                        # Application (client) ID depuis Azure
EMAIL_OAUTH_CLIENT_SECRET=                    # Client secret depuis Azure (sera chiffré en BDD)
EMAIL_OAUTH_SCOPES=https://graph.microsoft.com/.default  # Scopes OAuth (Graph API pour client credentials)
# =============================================================================